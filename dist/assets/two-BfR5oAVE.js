import{r as B,u as c,w as C,F as I}from"./FileSaver.min-CcbRIssf.js";import{_ as N}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{i as k,r as b,b as p,c as R,e as t,f as r,o as T,g as v,p as $,h as j,a as x}from"./index-smnFP8Mu.js";const y=f=>($("data-v-934334e0"),f=f(),j(),f),A={class:"container"},L=y(()=>x("i",{class:"el-icon-upload"},null,-1)),D=y(()=>x("div",{class:"el-upload__text"},[v("将文件拖到此处，或"),x("em",null,"点击上传")],-1)),E={__name:"two",setup(f){const l=k({one:"",two:"",three:"",four:"",five:"",six:""}),_=b(),F=k({one:[{required:!0,trigger:"blur",message:"必填"}],two:[{required:!0,trigger:"blur",message:"必填"}],three:[{required:!0,trigger:"blur",message:"必填"}],four:[{required:!0,trigger:"blur",message:"必填"}],five:[{required:!0,trigger:"blur",message:"必填"}],six:[{required:!0,trigger:"blur",message:"必填"}]}),g=b([]),m=b([]),S=async n=>{console.log(n);const e=n.raw;if(e.length<=0)return!1;if(!/\.(xls|xlsx)$/.test(e.name.toLowerCase()))return console.log("上传格式不正确，请上传xls或者xlsx格式"),!1;const u=new FileReader;u.onload=a=>{const s=B(a.target.result,{type:"binary"}),d=s.SheetNames[0],i=c.sheet_to_json(s.Sheets[d]);console.log(i),g.value=i},u.readAsBinaryString(e)},U=async n=>{n&&await n.validate((e,u)=>{if(e){g.value.forEach(o=>{const w=o[l.one]-o[l.four],V=o[l.two]-o[l.five],h=o[l.three]-o[l.six];w>-3&&w<3||V>-3&&V<3||h>-3&&h<3||(console.log(o),m.value.push(o))}),console.log(m.value);const a=c.json_to_sheet(m.value),s=c.book_new();c.book_append_sheet(s,a,"Sheet1");const d=C(s,{bookType:"xlsx",type:"array"}),i=new Blob([d],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet;charset=UTF-8"});I.saveAs(i,"test.xlsx"),g.value=[],m.value=[]}else console.log("error submit!",u)})},q=n=>{n&&n.resetFields()};return(n,e)=>{const u=p("el-upload"),a=p("el-input"),s=p("el-form-item"),d=p("el-button"),i=p("el-form");return T(),R("div",A,[t(u,{class:"upload-demo",action:"",drag:"","auto-upload":!1,"on-change":S,limit:1},{default:r(()=>[L,D]),_:1}),t(i,{ref_key:"ruleFormRef",ref:_,model:l,rules:F,"label-width":"120px",class:"demo-ruleForm","status-icon":""},{default:r(()=>[t(s,{label:"第一个表头",prop:"one"},{default:r(()=>[t(a,{modelValue:l.one,"onUpdate:modelValue":e[0]||(e[0]=o=>l.one=o)},null,8,["modelValue"])]),_:1}),t(s,{label:"第二个表头",prop:"two"},{default:r(()=>[t(a,{modelValue:l.two,"onUpdate:modelValue":e[1]||(e[1]=o=>l.two=o)},null,8,["modelValue"])]),_:1}),t(s,{label:"第三个表头",prop:"three"},{default:r(()=>[t(a,{modelValue:l.three,"onUpdate:modelValue":e[2]||(e[2]=o=>l.three=o)},null,8,["modelValue"])]),_:1}),t(s,{label:"第四个表头",prop:"four"},{default:r(()=>[t(a,{modelValue:l.four,"onUpdate:modelValue":e[3]||(e[3]=o=>l.four=o)},null,8,["modelValue"])]),_:1}),t(s,{label:"第五个表头",prop:"five"},{default:r(()=>[t(a,{modelValue:l.five,"onUpdate:modelValue":e[4]||(e[4]=o=>l.five=o)},null,8,["modelValue"])]),_:1}),t(s,{label:"第六个表头",prop:"six"},{default:r(()=>[t(a,{modelValue:l.six,"onUpdate:modelValue":e[5]||(e[5]=o=>l.six=o)},null,8,["modelValue"])]),_:1}),t(s,null,{default:r(()=>[t(d,{onClick:e[6]||(e[6]=o=>U(_.value))},{default:r(()=>[v("导出数据")]),_:1}),t(d,{onClick:e[7]||(e[7]=o=>q(_.value))},{default:r(()=>[v("清空")]),_:1})]),_:1})]),_:1},8,["model","rules"])])}}},J=N(E,[["__scopeId","data-v-934334e0"]]);export{J as default};
